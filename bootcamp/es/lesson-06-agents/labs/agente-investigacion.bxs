// agente-investigacion.bxs
// Laboratorio: Agente de investigaciÃ³n
// Ejecutar con: boxlang agente-investigacion.bxs

println( "ðŸ” Agente de InvestigaciÃ³n" )
println( "â•".repeat( 40 ) )
println()

// Base de conocimiento simulada
knowledgeBase = {
    "boxlang": "BoxLang is a modern dynamic JVM language with CFML compatibility.",
    "java": "Java is a widely-used programming language for enterprise applications.",
    "ai": "Artificial Intelligence enables machines to simulate human intelligence.",
    "llm": "Large Language Models are AI systems trained on vast text datasets."
}

// Crear herramienta de bÃºsqueda
searchTool = aiTool(
    "search",
    "Search the knowledge base for information",
    ( args ) => {
        query = args.query.lCase()
        for( topic in knowledgeBase.keyList() ) {
            if( query.findNoCase( topic ) > 0 ) {
                return "Found: " & knowledgeBase[ topic ]
            }
        }
        return "No results for '#args.query#'. Try: #knowledgeBase.keyList()#"
    }
).describeQuery( "What to search for" )

// Crear herramienta de resumen
summarizeTool = aiTool(
    "summarize",
    "Create a brief summary of given text",
    ( args ) => {
        text = args.text
        // SimulaciÃ³n simple - en app real, podrÃ­a usar IA
        return "Summary: " & left( text, 100 ) & "..."
    }
).describeText( "Text to summarize" )

// Crear el agente de investigaciÃ³n
researchAgent = aiAgent(
    name: "Researcher",
    description: "A research agent that searches and summarizes information",
    instructions: "
        You are a research assistant.
        - Search for topics when asked
        - Provide clear explanations
        - Summarize when requested
        - Remember what the user has asked about
    ",
    tools: [ searchTool, summarizeTool ],
    memory: aiMemory( "windowed", { maxMessages: 10 } )
)

// Bucle de chat
println( "Â¡PÃ­deme que investigue algo!" )
println( "Temas que conozco: #knowledgeBase.keyList()#" )
println( "â”€".repeat( 40 ) )
println()

running = true
while( running ) {
    print( "TÃº: " )
    userInput = readLine()

    if( userInput.trim() == "salir" ) {
        running = false
        println( "Â¡AdiÃ³s! ðŸ“š" )
    } else {
        try {
            response = researchAgent.run( userInput )
            println( "Investigador: " & response )
            println()
        } catch( any e ) {
            println( "Error: " & e.message )
            println()
        }
    }
}
