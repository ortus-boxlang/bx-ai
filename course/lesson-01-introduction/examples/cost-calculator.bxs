// cost-calculator.bxs
/**
 * AI Cost Calculator
 * Estimate costs before making expensive API calls
 */

import bxModules.bxai.models.util.TokenCounter;

println( "=== AI Cost Calculator ===" )
println()

// Current pricing (as of 2024 - check openai.com/pricing for updates)
pricing = {
    "gpt-3.5-turbo": {
        input: 0.0005,   // $0.50 per 1M tokens
        output: 0.0015   // $1.50 per 1M tokens
    },
    "gpt-4": {
        input: 0.03,     // $30 per 1M tokens
        output: 0.06     // $60 per 1M tokens
    },
    "gpt-4-turbo": {
        input: 0.01,     // $10 per 1M tokens
        output: 0.03     // $30 per 1M tokens
    }
}

// Example: Calculate cost for an essay request
prompt = "Write a detailed 1000-word essay about artificial intelligence"
estimatedInputTokens = TokenCounter::count( prompt )
estimatedOutputTokens = 1300  // ~1000 words â‰ˆ 1300 tokens

println( "Prompt: '#prompt#'" )
println( "Estimated input tokens: #estimatedInputTokens#" )
println( "Estimated output tokens: #estimatedOutputTokens#" )
println()

// Calculate for each model
pricing.each( ( model, prices ) => {
    inputCost = ( estimatedInputTokens / 1000000 ) * prices.input
    outputCost = ( estimatedOutputTokens / 1000000 ) * prices.output
    totalCost = inputCost + outputCost
    
    println( "Model: #model#" )
    println( "  Input cost:  $#numberFormat( inputCost, '0.000000' )#" )
    println( "  Output cost: $#numberFormat( outputCost, '0.000000' )#" )
    println( "  Total cost:  $#numberFormat( totalCost, '0.000000' )#" )
    println()
} )

println( "ðŸ’¡ Tip: Use gpt-3.5-turbo for simple tasks to save costs!" )
println( "ðŸ’¡ Tip: Use Ollama (free) for development and testing!" )
